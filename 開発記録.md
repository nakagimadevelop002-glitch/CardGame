# ResearchTCG 開発記録

## プロジェクト概要
リサーチ用のミニマルTCG（トレーディングカードゲーム）。
参加者の反応時間とカード選択をログ記録。
マナ管理システムと属性相性による戦略的なゲームプレイ。

---

## 現在の実装状況（2025年10月25日）

### ゲームルール
- 各プレイヤーはランダムなデッキ（20枚）を持つ
- 初期手札5枚、**初期マナ0**（駆け引き重視）
- 3フェーズ制ターンシステム:
  1. **マナ獲得フェーズ**: 手札から1枚捨て札→攻撃力分のマナ獲得
  2. **カード選択フェーズ**: マナアクション（ブースト/マリガン/スキップ）→カードプレイ
  3. **バトルフェーズ**: 攻撃力比較→勝者に1ポイント
- **攻撃力が高い方が勝利**
- **攻撃力が同じ場合 → 属性相性で判定**
- 勝者に1ポイント
- 両者2枚ドローして次のターンへ
- **コスト不足で出せるカードがない場合 → 不戦敗**（AIに1ポイント＋ペナルティ）

### 属性相性システム（ポケモン式）
各属性は2つに強く、2つに弱い完全バランス型
```
Fire（火）:   ○ Nature, Air    × Water, Earth
Water（水）:  ○ Fire, Earth    × Nature, Air
Nature（自然）:○ Water, Earth   × Fire, Air
Earth（土）:  ○ Fire, Air      × Water, Nature
Air（風）:    ○ Water, Nature  × Fire, Earth
```
- Fire burns Nature, Air feeds Fire
- Water extinguishes Fire, Water erodes Earth
- Nature absorbs Water, Nature breaks Earth
- Earth suppresses Fire, Earth blocks Air
- Air evaporates Water, Air withers Nature

### マナシステム（2025年10月25日実装）
- **捨て札マナシステム**: 手札を捨てて攻撃力分のマナ獲得
- **マナアクション**:
  - **ブースト**: マナ消費で次のカード攻撃力UP（ATK+1/+2/+3を選択可能）
  - **マリガン**: マナ3消費で手札1枚を引き直し
  - **スキップ**: マナアクションを使用せずカード選択へ
- **コストシステム**: 各カードにコスト設定、マナ不足だと出せない
- **不戦敗システム**: コスト不足でカードが出せない場合、超派手演出で不戦敗→AIに1ポイント＋ペナルティ

### UI改善完了（2025年10月22日）
- カード画像の高品質化（圧縮無効、Trilinearフィルタ、異方性16、ミップマップ無効）
- カードサイズ拡大（手札180x260、フィールド320x450）
- 属性ごとの色分け（Fire=赤、Water=青、Nature=緑、Earth=茶、Air=水色）
- テキストの見やすさ向上（影付き、サイズ拡大、攻撃力56pt）
- テキスト配置調整（攻撃力を下部に移動、属性画像と重ならない）
- ホバーエフェクト追加（手札カード、1.1倍拡大）
- バトル演出追加：
  - カード出現アニメーション（透明→1.5倍→1.0倍、0.6秒）
  - 0.8秒の緊張の間
  - 画面中央に勝敗を大きく表示（200ptフォント、2.0倍スケール）
  - 勝利=緑、敗北=赤、引き分け=黄色
  - 属性有利で勝った場合は「（属性有利）」と表示
  - 2.0秒表示後フェードアウト
  - 半透明黒背景（alpha 0.7）でコントラスト向上
  - 画面揺れ、勝利パーティクル20個、画面フラッシュ

### カードエフェクト大幅強化（2025年10月25日）
全25枚のカードに**超派手な専用エフェクト**を実装（通常の3倍規模）:

**Fire属性（F1-F5）:**
- F1 Fire Wolf: 150個の炎、画面揺れ20f、赤フラッシュ
- F2 Flame Imp: 45個の火球、3本のトレイル
- F3 Blaze Golem: 2400サイズの炎の壁、80個の余燼
- F4 Lava Drake: 240幅の溶岩ビーム、60個の溶岩滴
- F5 Cinder Fox: 36本の炎の尾、50個のスパークル

**Water属性（W1-W5）:**
- W1 Water Spirit: 90個の水滴、50個の水飛沫
- W2 Tide Caller: 9つの巨大波、3重の波紋
- W3 Ice Guardian: 300x600の氷の盾、18本の氷柱
- W4 Stream Pixie: 45個の水滴、広域拡散
- W5 Aqua Serpent: 120サイズの水蛇、30個の軌跡

**Nature属性（N1-N5）:**
- N1 Forest Elf: 100個の葉っぱ、50個の竜巻パーティクル
- N2 Vine Beast: 8本の巨大蔦（60-100px）、60個のトゲ
- N3 Grove Guardian: 400pt「森」文字、150個の葉爆発、12本の根
- N4 Moss Turtle: 5層1200pxの巨大盾、100個の苔
- N5 Thorn Stalker: 100個の巨大トゲ弾幕、120個の茨破片

**Earth属性（E1-E5）:**
- E1 Rock Giant: 24本の画面裂き地割れ、150個の岩破片
- E2 Clay Golem: 30個の隕石級岩石、100個の土煙
- E3 Stone Boar: 200pt巨大猪突進、80個の土煙、100個の衝突破片
- E4 Granite Rhino: 300pt「震」文字、120個の跳ねる岩、15本の地割れ波
- E5 Pebble Sprite: 150個の小石マシンガン、80個の砂塵

**Air属性（A1-A5）:**
- A1 Wind Hawk: 18本の250x20巨大風刃、100個の風パーティクル
- A2 Gust Fox: 100個の風文字竜巻、80個の吸い込まれる破片
- A3 Sky Golem: 120本の暴風線、100個の風圧パーティクル
- A4 Whirl Pixie: 60個の3グループ旋風、90個の軌跡
- A5 Storm Drake: 5個の巨大雷雲、30本の稲妻、80個の雷パーティクル

**共通演出:**
- 全カードに画面揺れ、フラッシュ、大量パーティクル
- 攻撃力7以上のカードは画面全体規模の特別エフェクト
- 継続時間1.2-2.2秒（通常の3倍）

### ゲーム終了演出（2025年10月25日実装）
**超派手な最終結果画面:**
- 全画面暗転背景（alpha 0.9）
- 勝敗テキスト爆発的拡大（1pt→200pt、0.6秒）
  - 勝利: 金色「大勝利！」
  - 引き分け: 黄色「引き分け」
  - 敗北: 赤色「敗北」
- スコア表示（80pt）フェードイン＋拡大
- 再戦ボタン（400x100、60pt）脈動エフェクト付き
- 300個のパーティクル（勝利=祝/勝、引き分け=分、敗北=負）
- 画面全体揺れ（勝利40、引き分け20、敗北30）
- 勝敗に応じた色のフラッシュ（ランダム強調）
- 3秒間の派手アニメーション

**不戦敗専用演出:**
- 180pt「不戦敗」テキスト（激しい赤黒点滅50Hz）
- 50pt「コスト不足 出せるカードがありません」
- 200個のバツ印（×）パーティクル（50-120pt）
- 50個の「失格」文字（回転飛散）
- 画面揺れ強度35
- 赤い警告フラッシュ（ランダム強調）
- 2.5秒間の警告演出

### 技術スタック
- Unity 2022.3+
- Legacy UI (uGUI)
- カードデータ: JSON形式 (Resources/card_data.json)
- ログ出力: CSV形式 (DataLogger.cs)

---

## 今後の拡張案

### コストシステム案（未実装・検討中）
```
提案: 捨て札マナシステム
- カードを出す際、手札から1枚を捨てる
- 捨てたカードの攻撃力がそのままマナになる
- マナはターンを跨いで持ち越し可能
- コスト以下のマナがないとカードを出せない

戦略性:
- 弱いカードを捨ててマナを少しずつ貯める
- 強いカードを捨てて一気にマナを増やす
- 手札管理とリソース管理の両立が必要
```

### その他の改善案
- [ ] 捨て札マナシステムの実装
- [ ] デッキ構築機能
- [ ] カードタイプ別の特殊効果
- [ ] より詳細なログ（マナ使用状況など）
- [ ] リプレイ機能

---

## 開発履歴

- **2025年10月22日**: ResearchTCG UI大幅改善、属性相性システム（ポケモン式）実装、バトル演出強化
